<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Home System</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .tab-content {
            padding: 20px;
            border: 1px solid #dee2e6;
            border-top: none;
            border-radius: 0 0 5px 5px;
        }
        .table-actions {
            white-space: nowrap;
        }
        .device-active {
            color: #198754;
        }
        .device-inactive {
            color: #dc3545;
        }
        .loading {
            opacity: 0.6;
            pointer-events: none;
        }
    </style>
</head>
<body>
    <div class="container-fluid py-4">
        <h1 class="text-center mb-4">üè† Smart Home System</h1>
        
        <!-- –ù–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω—ã–µ –≤–∫–ª–∞–¥–∫–∏ -->
        <ul class="nav nav-tabs" id="myTab" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="devices-tab" data-bs-toggle="tab" data-bs-target="#devices" type="button" role="tab">–£—Å—Ç—Ä–æ–π—Å—Ç–≤–∞</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="modes-tab" data-bs-toggle="tab" data-bs-target="#modes" type="button" role="tab">–†–µ–∂–∏–º—ã</button>
            </li>
        </ul>

        <!-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –≤–∫–ª–∞–¥–æ–∫ -->
        <div class="tab-content" id="myTabContent">
            
            <!-- –í–∫–ª–∞–¥–∫–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ -->
            <div class="tab-pane fade show active" id="devices" role="tabpanel">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏</h3>
                    <button class="btn btn-primary" onclick="showDeviceModal()">
                        <i class="fas fa-plus"></i> –î–æ–±–∞–≤–∏—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ
                    </button>
                </div>
                
                <!-- –§–∏–ª—å—Ç—Ä—ã —É—Å—Ç—Ä–æ–π—Å—Ç–≤ -->
                <div class="card mb-3">
                    <div class="card-body">
                        <h5 class="card-title">–§–∏–ª—å—Ç—Ä—ã</h5>
                        <div class="row g-3">
                            <div class="col-md-2">
                                <input type="text" class="form-control" id="filterDeviceTitle" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ">
                            </div>
                            <div class="col-md-2">
                                <input type="number" class="form-control" id="filterMinPower" placeholder="–ú–∏–Ω. –º–æ—â–Ω–æ—Å—Ç—å">
                            </div>
                            <div class="col-md-2">
                                <input type="number" class="form-control" id="filterMaxPower" placeholder="–ú–∞–∫—Å. –º–æ—â–Ω–æ—Å—Ç—å">
                            </div>
                            <div class="col-md-2">
                                <select class="form-select" id="filterActivity">
                                    <option value="">–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã</option>
                                    <option value="true">–ê–∫—Ç–∏–≤–Ω—ã–µ</option>
                                    <option value="false">–ù–µ–∞–∫—Ç–∏–≤–Ω—ã–µ</option>
                                </select>
                            </div>
                            <div class="col-md-2">
                                <select class="form-select" id="filterDeviceType">
                                    <option value="">–í—Å–µ —Ç–∏–ø—ã</option>
                                    <option value="light">Light</option>
                                    <option value="coffee_machine">Coffee Machine</option>
                                    <option value="speakers">Speakers</option>
                                    <option value="kettle">Kettle</option>
                                    <option value="microwave">Microwave</option>
                                    <option value="door">Door</option>
                                    <option value="conditioner">Conditioner</option>
                                </select>
                            </div>
                            <div class="col-md-2">
                                <button class="btn btn-outline-primary w-100" onclick="loadDevices()">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="table-responsive">
                    <table class="table table-striped table-hover">
                        <thead class="table-dark">
                            <tr>
                                <th>ID</th>
                                <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                                <th>–¢–∏–ø</th>
                                <th>–ú–æ—â–Ω–æ—Å—Ç—å</th>
                                <th>–°—Ç–∞—Ç—É—Å</th>
                                <th>–†–µ–∂–∏–º</th>
                                <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                            </tr>
                        </thead>
                        <tbody id="devicesTableBody">
                            <!-- –î–∞–Ω–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- –í–∫–ª–∞–¥–∫–∞ —Ä–µ–∂–∏–º–æ–≤ -->
            <div class="tab-pane fade" id="modes" role="tabpanel">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞–º–∏</h3>
                    <button class="btn btn-primary" onclick="showModeModal()">
                        <i class="fas fa-plus"></i> –î–æ–±–∞–≤–∏—Ç—å —Ä–µ–∂–∏–º
                    </button>
                </div>
                
                <!-- –§–∏–ª—å—Ç—Ä—ã —Ä–µ–∂–∏–º–æ–≤ -->
                <div class="card mb-3">
                    <div class="card-body">
                        <h5 class="card-title">–§–∏–ª—å—Ç—Ä—ã</h5>
                        <div class="row g-3">
                            <div class="col-md-4">
                                <input type="text" class="form-control" id="filterModeTitle" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ">
                            </div>
                            <div class="col-md-4">
                                <select class="form-select" id="filterModeType">
                                    <option value="">–í—Å–µ —Ç–∏–ø—ã</option>
                                    <option value="dinner">Dinner</option>
                                    <option value="morning">Morning</option>
                                    <option value="study">Study</option>
                                </select>
                            </div>
                            <div class="col-md-4">
                                <button class="btn btn-outline-primary w-100" onclick="loadModes()">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="table-responsive">
                    <table class="table table-striped table-hover">
                        <thead class="table-dark">
                            <tr>
                                <th>ID</th>
                                <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                                <th>–¢–∏–ø</th>
                                <th>–ö–æ–ª-–≤–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤</th>
                                <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                            </tr>
                        </thead>
                        <tbody id="modesTableBody">
                            <!-- –î–∞–Ω–Ω—ã–µ —Ä–µ–∂–∏–º–æ–≤ –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤ -->
    <div class="modal fade" id="deviceModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="deviceModalTitle">–î–æ–±–∞–≤–∏—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="deviceForm">
                        <input type="hidden" id="deviceId">
                        <div class="mb-3">
                            <label class="form-label">ID (—Ä—É—á–Ω–æ–π –≤–≤–æ–¥)</label>
                            <input type="number" class="form-control" id="deviceIdInput" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ *</label>
                            <input type="text" class="form-control" id="deviceTitle" required maxlength="150">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">–¢–∏–ø</label>
                            <select class="form-select" id="deviceType">
                                <option value="light">Light</option>
                                <option value="coffee_machine">Coffee Machine</option>
                                <option value="speakers">Speakers</option>
                                <option value="kettle">Kettle</option>
                                <option value="microwave">Microwave</option>
                                <option value="door">Door</option>
                                <option value="conditioner">Conditioner</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">–ú–æ—â–Ω–æ—Å—Ç—å</label>
                            <input type="number" step="0.1" class="form-control" id="devicePower">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">–†–µ–∂–∏–º (ID)</label>
                            <input type="number" class="form-control" id="deviceModeId">
                        </div>
                        <div class="form-check mb-3">
                            <input class="form-check-input" type="checkbox" id="deviceActive">
                            <label class="form-check-label">–ê–∫—Ç–∏–≤–Ω–æ–µ</label>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–û—Ç–º–µ–Ω–∞</button>
                    <button type="button" class="btn btn-primary" onclick="saveDevice()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —Ä–µ–∂–∏–º–æ–≤ -->
    <div class="modal fade" id="modeModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="modeModalTitle">–î–æ–±–∞–≤–∏—Ç—å —Ä–µ–∂–∏–º</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="modeForm">
                        <input type="hidden" id="modeId">
                        <div class="mb-3">
                            <label class="form-label">ID (—Ä—É—á–Ω–æ–π –≤–≤–æ–¥)</label>
                            <input type="number" class="form-control" id="modeIdInput" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ *</label>
                            <input type="text" class="form-control" id="modeTitle" required maxlength="150">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">–¢–∏–ø</label>
                            <select class="form-select" id="modeType">
                                <option value="dinner">Dinner</option>
                                <option value="morning">Morning</option>
                                <option value="study">Study</option>
                            </select>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–û—Ç–º–µ–Ω–∞</button>
                    <button type="button" class="btn btn-primary" onclick="saveMode()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        const API_BASE = 'http://localhost:8080';
        
        // CORS –ø—Ä–æ–∫—Å–∏ –¥–ª—è –æ–±—Ö–æ–¥–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –±—Ä–∞—É–∑–µ—Ä–∞
        async function fetchWithCORS(url, options = {}) {
            try {
                const response = await fetch(url, {
                    ...options,
                    mode: 'cors',
                    headers: {
                        'Content-Type': 'application/json',
                        ...options.headers,
                    },
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                return await response.json();
            } catch (error) {
                console.error('Fetch error:', error);
                alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∑–∞–ø—Ä–æ—Å–∞: ' + error.message);
                throw error;
            }
        }

        // –£—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
        async function loadDevices() {
            try {
                const params = new URLSearchParams({
                    title: document.getElementById('filterDeviceTitle').value || '',
                    min_power: document.getElementById('filterMinPower').value || '',
                    max_power: document.getElementById('filterMaxPower').value || '',
                    activity: document.getElementById('filterActivity').value || '',
                    type: document.getElementById('filterDeviceType').value || ''
                });

                const devices = await fetchWithCORS(`${API_BASE}/devices/filter?${params}`);
                renderDevicesTable(devices.content || devices);
            } catch (error) {
                document.getElementById('devicesTableBody').innerHTML = 
                    '<tr><td colspan="7" class="text-center text-danger">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö</td></tr>';
            }
        }

        function renderDevicesTable(devices) {
            const tbody = document.getElementById('devicesTableBody');
            
            if (!devices || devices.length === 0) {
                tbody.innerHTML = '<tr><td colspan="7" class="text-center">–£—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</td></tr>';
                return;
            }

            tbody.innerHTML = devices.map(device => `
                <tr>
                    <td>${device.id}</td>
                    <td>${device.title}</td>
                    <td>${device.type}</td>
                    <td>${device.power || '-'}</td>
                    <td>
                        <i class="fas ${device.active ? 'fa-check device-active' : 'fa-times device-inactive'}"></i>
                        ${device.active ? '–ê–∫—Ç–∏–≤–Ω–æ' : '–ù–µ–∞–∫—Ç–∏–≤–Ω–æ'}
                    </td>
                    <td>${device.mode ? device.mode.title : '–ù–µ—Ç'}</td>
                    <td class="table-actions">
                        <button class="btn btn-sm btn-outline-primary" onclick="editDevice(${device.id})">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-sm btn-outline-danger" onclick="deleteDevice(${device.id})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                </tr>
            `).join('');
        }

        function showDeviceModal(device = null) {
            const modal = new bootstrap.Modal(document.getElementById('deviceModal'));
            const title = document.getElementById('deviceModalTitle');
            const form = document.getElementById('deviceForm');
            
            form.reset();
            
            if (device) {
                title.textContent = '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ';
                document.getElementById('deviceId').value = device.id;
                document.getElementById('deviceIdInput').value = device.id;
                document.getElementById('deviceTitle').value = device.title;
                document.getElementById('deviceType').value = device.type;
                document.getElementById('devicePower').value = device.power || '';
                document.getElementById('deviceModeId').value = device.mode ? device.mode.id : '';
                document.getElementById('deviceActive').checked = device.active;
            } else {
                title.textContent = '–î–æ–±–∞–≤–∏—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ';
                document.getElementById('deviceIdInput').value = '';
            }
            
            modal.show();
        }

        async function saveDevice() {
            const deviceData = {
                id: parseInt(document.getElementById('deviceIdInput').value),
                title: document.getElementById('deviceTitle').value,
                type: document.getElementById('deviceType').value,
                power: document.getElementById('devicePower').value ? parseFloat(document.getElementById('devicePower').value) : null,
                active: document.getElementById('deviceActive').checked
            };

            const modeId = document.getElementById('deviceModeId').value;
            if (modeId) {
                try {
                    const mode = await fetchWithCORS(`${API_BASE}/modes/${modeId}`);
                    deviceData.mode = mode;
                } catch (error) {
                    alert('–†–µ–∂–∏–º —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º ID –Ω–µ –Ω–∞–π–¥–µ–Ω');
                    return;
                }
            }

            try {
                const existingId = document.getElementById('deviceId').value;
                if (existingId) {
                    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ
                    await fetchWithCORS(`${API_BASE}/devices/${existingId}`, {
                        method: 'PUT',
                        body: JSON.stringify(deviceData)
                    });
                } else {
                    // –°–æ–∑–¥–∞–Ω–∏–µ
                    await fetchWithCORS(`${API_BASE}/devices`, {
                        method: 'POST',
                        body: JSON.stringify(deviceData)
                    });
                }

                bootstrap.Modal.getInstance(document.getElementById('deviceModal')).hide();
                loadDevices();
                alert('–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ!');
            } catch (error) {
                alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞');
            }
        }

        async function editDevice(id) {
            try {
                const device = await fetchWithCORS(`${API_BASE}/devices/${id}`);
                showDeviceModal(device);
            } catch (error) {
                alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞');
            }
        }

        async function deleteDevice(id) {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ?')) {
                try {
                    await fetchWithCORS(`${API_BASE}/devices/${id}`, {
                        method: 'DELETE'
                    });
                    loadDevices();
                    alert('–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω–æ!');
                } catch (error) {
                    alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞');
                }
            }
        }

        // –†–µ–∂–∏–º—ã
        async function loadModes() {
            try {
                const params = new URLSearchParams({
                    title: document.getElementById('filterModeTitle').value || '',
                    type: document.getElementById('filterModeType').value || ''
                });

                const modes = await fetchWithCORS(`${API_BASE}/modes/filter?${params}`);
                renderModesTable(modes.content || modes);
            } catch (error) {
                document.getElementById('modesTableBody').innerHTML = 
                    '<tr><td colspan="5" class="text-center text-danger">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö</td></tr>';
            }
        }

        function renderModesTable(modes) {
            const tbody = document.getElementById('modesTableBody');
            
            if (!modes || modes.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" class="text-center">–†–µ–∂–∏–º—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</td></tr>';
                return;
            }

            tbody.innerHTML = modes.map(mode => `
                <tr>
                    <td>${mode.id}</td>
                    <td>${mode.title}</td>
                    <td>${mode.type}</td>
                    <td>${mode.devices ? mode.devices.length : 0}</td>
                    <td class="table-actions">
                        <button class="btn btn-sm btn-outline-primary" onclick="editMode(${mode.id})">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-sm btn-outline-danger" onclick="deleteMode(${mode.id})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                </tr>
            `).join('');
        }

        function showModeModal(mode = null) {
            const modal = new bootstrap.Modal(document.getElementById('modeModal'));
            const title = document.getElementById('modeModalTitle');
            const form = document.getElementById('modeForm');
            
            form.reset();
            
            if (mode) {
                title.textContent = '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∂–∏–º';
                document.getElementById('modeId').value = mode.id;
                document.getElementById('modeIdInput').value = mode.id;
                document.getElementById('modeTitle').value = mode.title;
                document.getElementById('modeType').value = mode.type;
            } else {
                title.textContent = '–î–æ–±–∞–≤–∏—Ç—å —Ä–µ–∂–∏–º';
                document.getElementById('modeIdInput').value = '';
            }
            
            modal.show();
        }

        async function saveMode() {
            const modeData = {
                id: parseInt(document.getElementById('modeIdInput').value),
                title: document.getElementById('modeTitle').value,
                type: document.getElementById('modeType').value
            };

            try {
                const existingId = document.getElementById('modeId').value;
                if (existingId) {
                    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ
                    await fetchWithCORS(`${API_BASE}/modes/${existingId}`, {
                        method: 'PUT',
                        body: JSON.stringify(modeData)
                    });
                } else {
                    // –°–æ–∑–¥–∞–Ω–∏–µ
                    await fetchWithCORS(`${API_BASE}/modes`, {
                        method: 'POST',
                        body: JSON.stringify(modeData)
                    });
                }

                bootstrap.Modal.getInstance(document.getElementById('modeModal')).hide();
                loadModes();
                alert('–†–µ–∂–∏–º —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω!');
            } catch (error) {
                alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ —Ä–µ–∂–∏–º–∞');
            }
        }

        async function editMode(id) {
            try {
                const mode = await fetchWithCORS(`${API_BASE}/modes/${id}`);
                showModeModal(mode);
            } catch (error) {
                alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ä–µ–∂–∏–º–∞');
            }
        }

        async function deleteMode(id) {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç —Ä–µ–∂–∏–º?')) {
                try {
                    await fetchWithCORS(`${API_BASE}/modes/${id}`, {
                        method: 'DELETE'
                    });
                    loadModes();
                    alert('–†–µ–∂–∏–º —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω!');
                } catch (error) {
                    alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —Ä–µ–∂–∏–º–∞');
                }
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', function() {
            loadDevices();
            loadModes();
        });
    </script>
</body>
</html>